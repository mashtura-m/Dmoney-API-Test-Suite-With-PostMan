{
	"info": {
		"_postman_id": "50488459-3101b5c4-a838-400b-8ae4-ac575304168e",
		"name": "Dmoney-API-Test-Suite-With-PM",
		"description": "A professionally structured collection for Dmoney REST API following the end-to-end lifecycle of financial transactions.",
		"schema": "https://schema.getpostman.com/json/collection/v2.1.0/collection.json"
	},
	"item": [
		{
			"name": "01. Security & Authentication",
			"item": [
				{
					"name": "Admin Login - Invalid Password",
					"id": "50488459-523a982f-2bae-421b-8192-582dd8e3911f",
					"protocolProfileBehavior": {
						"disableBodyPruning": true
					},
					"request": {
						"method": "POST",
						"header": [],
						"body": {
							"mode": "raw",
							"raw": "{\"email\": \"{{adminEmail}}\", \"password\": \"wrong\"}"
						},
						"url": {
							"raw": "{{baseUrl}}/user/login",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"user",
								"login"
							]
						}
					},
					"response": []
				},
				{
					"name": "Admin Login - Valid",
					"event": [
						{
							"listen": "test",
							"script": {
								"id": "dc421506-41a3-4057-a2e3-953ead2d9ddc",
								"exec": [
									"",
									"if (pm.response.code === 200) {    ",
									"",
									"    var jsonData = pm.response.json();",
									"",
									"    // 3. Extract the token and save it to Collection Variables",
									"    if (jsonData.token) {",
									"        let role=jsonData.role",
									"        console.log(\"ROLE: \"+role)",
									"        let auth_token=role+\"-auth-token\"",
									"        pm.collectionVariables.set(auth_token, jsonData.token);",
									"        console.log(\"Success: Token saved to collection variable 'role-auth-token'\"+pm.auth_token);",
									"    } else {",
									"        console.log(\"Error: Token field not found in response body\");",
									"    }",
									"",
									"} else {",
									"    console.log(\"Login failed. Status code: \" + pm.response.code);",
									"}",
									"// pm.test(\"Status code is 200\", function () {",
									"//     pm.response.to.have.status(200);",
									"// });",
									"// pm.test(\"Login successfully\", function () {",
									"//     pm.expect(pm.response.text()).contains(\"Login successful\");",
									"// });",
									""
								],
								"type": "text/javascript",
								"packages": {},
								"requests": {}
							}
						}
					],
					"id": "50488459-42064d94-6fbc-474d-8d7c-b2462377bbe9",
					"protocolProfileBehavior": {
						"disableBodyPruning": true
					},
					"request": {
						"method": "POST",
						"header": [],
						"body": {
							"mode": "raw",
							"raw": "{\n    \"email\": \"{{adminEmail}}\",\n    \"password\": \"1234\"\n}",
							"options": {
								"raw": {
									"language": "json"
								}
							}
						},
						"url": {
							"raw": "{{baseUrl}}/user/login",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"user",
								"login"
							]
						}
					},
					"response": []
				}
			],
			"id": "50488459-6cabae78-fab7-452d-8140-94b83848c52b",
			"description": "Handles Admin login and token retrieval.",
			"event": [
				{
					"listen": "prerequest",
					"script": {
						"id": "362ada38-7370-472b-9997-d9dbcb358e2f",
						"type": "text/javascript",
						"packages": {},
						"requests": {},
						"exec": [
							""
						]
					}
				},
				{
					"listen": "test",
					"script": {
						"id": "824d5528-bdef-4572-aad9-e5dba1d18d58",
						"type": "text/javascript",
						"packages": {},
						"requests": {},
						"exec": [
							"pm.test(\"Status code is 200\", function () {",
							"    pm.response.to.have.status(200);",
							"});",
							"pm.test(\"Login successfully\", function () {",
							"    pm.expect(pm.response.text()).contains(\"Login successful\");",
							"});",
							""
						]
					}
				}
			]
		},
		{
			"name": "02. User Onboarding",
			"item": [
				{
					"name": "Positive Scenarios",
					"item": [
						{
							"name": "Create Agent",
							"event": [
								{
									"listen": "prerequest",
									"script": {
										"id": "0a6b81e7-f106-41e9-901b-043ea35dd543",
										"exec": [
											"// 1. Generate Random Name",
											"const name = \"{{$randomFullName}}\";",
											"",
											"// 2. Generate Random Email",
											"const email = \"{{$randomEmail}}\"",
											"",
											"// 3. Generate Random Password",
											"const password = _.sampleSize('abcdefghijklmnopqrstuvwxyz0123456789', 4).join('');",
											"",
											"// 4. Generate 11-Digit Phone Number (Starts with 01, then 9 random digits)",
											"const phoneNumber = \"01\" + _.times(9, () => _.random(0, 9)).join('');",
											"",
											"// 5. Generate NID (Within 13 characters)",
											"const nid = _.times(13, () => _.random(0, 9)).join('');",
											"",
											"// 6. Define role for this request",
											"const role = \"Agent\";",
											"",
											"// 7. Save Phone Number to local variables for further tests",
											"pm.variables.set(\"random_phone\", phoneNumber);",
											"pm.variables.set(\"random_role\", role);",
											""
										],
										"type": "text/javascript",
										"packages": {},
										"requests": {}
									}
								}
							],
							"id": "50488459-b5fb8bf4-8600-48ff-927a-f8c9a0154eab",
							"protocolProfileBehavior": {
								"disableBodyPruning": true
							},
							"request": {
								"method": "POST",
								"header": [],
								"body": {
									"mode": "raw",
									"raw": "{\n  \"name\": \"{{name}}\",\n  \"email\": \"{{email}}\",\n  \"password\": \"{{password}}\",\n  \"phone_number\": \"{{phone_number}}\",\n  \"nid\": \"{{nid}}\",\n  \"role\": \"Agent\"\n}"
								},
								"url": {
									"raw": "{{baseUrl}}/user/create",
									"host": [
										"{{baseUrl}}"
									],
									"path": [
										"user",
										"create"
									]
								}
							},
							"response": []
						},
						{
							"name": "Create Customer 1",
							"event": [
								{
									"listen": "prerequest",
									"script": {
										"type": "text/javascript",
										"exec": [
											"// 1. Generate Random Name",
											"const name = \"{{$randomFullName}}\";",
											"",
											"// 2. Generate Random Email",
											"const email = \"{{$randomEmail}}\"",
											"",
											"// 3. Generate Random Password",
											"const password = _.sampleSize('abcdefghijklmnopqrstuvwxyz0123456789', 4).join('');",
											"",
											"// 4. Generate 11-Digit Phone Number (Starts with 01, then 9 random digits)",
											"const phoneNumber = \"01\" + _.times(9, () => _.random(0, 9)).join('');",
											"",
											"// 5. Generate NID (Within 13 characters)",
											"const nid = _.times(13, () => _.random(0, 9)).join('');",
											"",
											"// 6. Define role for this request",
											"const role = \"Customer\";",
											"",
											"// 7. Save Phone Number to local variables for further tests",
											"pm.variables.set(\"random_phone\", phoneNumber);",
											"pm.variables.set(\"random_role\", role);",
											""
										]
									}
								}
							],
							"id": "50488459-3e303624-3b36-4328-95fb-c630a81f1ae1",
							"protocolProfileBehavior": {
								"disableBodyPruning": true
							},
							"request": {
								"method": "POST",
								"header": [],
								"body": {
									"mode": "raw",
									"raw": "{\n  \"name\": \"{{name}}\",\n  \"email\": \"{{email}}\",\n  \"password\": \"{{password}}\",\n  \"phone_number\": \"{{phone_number}}\",\n  \"nid\": \"{{nid}}\",\n  \"role\": \"Agent\"\n}"
								},
								"url": {
									"raw": "{{baseUrl}}/user/create",
									"host": [
										"{{baseUrl}}"
									],
									"path": [
										"user",
										"create"
									]
								}
							},
							"response": []
						},
						{
							"name": "Create Customer 2",
							"event": [
								{
									"listen": "prerequest",
									"script": {
										"type": "text/javascript",
										"exec": [
											"// 1. Generate Random Name using Postman dynamic variable",
											"const name = pm.variables.replaceIn(\"{{$randomFullName}}\");",
											"",
											"// 2. Generate Random Email using Postman dynamic variable",
											"const email = pm.variables.replaceIn(\"{{$randomEmail}}\");",
											"",
											"// 3. Set Fixed Password",
											"const password = \"MMM1234\";",
											"",
											"// 4. Generate 11-Digit Phone Number (Starts with 01, then 9 random digits)",
											"const phoneNumber = \"01\" + pm.variables.replaceIn(\"{{$randomInt}}\").toString().padStart(9, '0').slice(0, 9);",
											"",
											"// 5. Generate NID (13 digits)",
											"const nid = pm.variables.replaceIn(\"{{$randomInt}}\").toString().padStart(7, '0').slice(0, 7) + pm.variables.replaceIn(\"{{$randomInt}}\").toString().padStart(6, '0').slice(0, 6);",
											"",
											"// 6. Define role for this request",
											"const role = \"Customer\";",
											"",
											"// Set variables for use in request body",
											"pm.variables.set(\"name\", name);",
											"pm.variables.set(\"email\", email);",
											"pm.variables.set(\"password\", password);",
											"pm.variables.set(\"phone_number\", phoneNumber);",
											"pm.variables.set(\"nid\", nid);"
										]
									}
								}
							],
							"id": "50488459-93aefe26-46ba-439b-b457-834394683607",
							"protocolProfileBehavior": {
								"disableBodyPruning": true
							},
							"request": {
								"method": "POST",
								"header": [],
								"body": {
									"mode": "raw",
									"raw": "{\n  \"name\": \"{{name}}\",\n  \"email\": \"{{email}}\",\n  \"password\": \"{{password}}\",\n  \"phone_number\": \"{{phone_number}}\",\n  \"nid\": \"{{nid}}\",\n  \"role\": \"Agent\"\n}"
								},
								"url": {
									"raw": "{{baseUrl}}/user/create",
									"host": [
										"{{baseUrl}}"
									],
									"path": [
										"user",
										"create"
									]
								}
							},
							"response": []
						},
						{
							"name": "Create Merchant",
							"event": [
								{
									"listen": "prerequest",
									"script": {
										"type": "text/javascript",
										"exec": [
											"// 1. Generate Random Name using Postman dynamic variable",
											"const name = pm.variables.replaceIn(\"{{$randomFullName}}\");",
											"",
											"// 2. Generate Random Email using Postman dynamic variable",
											"const email = pm.variables.replaceIn(\"{{$randomEmail}}\");",
											"",
											"// 3. Set Fixed Password",
											"const password = \"MMM1234\";",
											"",
											"// 4. Generate 11-Digit Phone Number (Starts with 01, then 9 random digits)",
											"const phoneNumber = \"01\" + pm.variables.replaceIn(\"{{$randomInt}}\").toString().padStart(9, '0').slice(0, 9);",
											"",
											"// 5. Generate NID (13 digits)",
											"const nid = pm.variables.replaceIn(\"{{$randomInt}}\").toString().padStart(7, '0').slice(0, 7) + pm.variables.replaceIn(\"{{$randomInt}}\").toString().padStart(6, '0').slice(0, 6);",
											"",
											"// 6. Define role for this request",
											"const role = \"Customer\";",
											""
										]
									}
								}
							],
							"id": "50488459-97c0c508-2b88-4a26-8528-728ec00dce3e",
							"protocolProfileBehavior": {
								"disableBodyPruning": true
							},
							"request": {
								"method": "POST",
								"header": [],
								"body": {
									"mode": "raw",
									"raw": "{\n  \"name\": \"{{name}}\",\n  \"email\": \"{{email}}\",\n  \"password\": \"{{password}}\",\n  \"phone_number\": \"{{phone_number}}\",\n  \"nid\": \"{{nid}}\",\n  \"role\": \"Agent\"\n}"
								},
								"url": {
									"raw": "{{baseUrl}}/user/create",
									"host": [
										"{{baseUrl}}"
									],
									"path": [
										"user",
										"create"
									]
								}
							},
							"response": []
						}
					],
					"id": "50488459-e4f19f25-7ae6-4751-93d6-dc19521b7d60"
				},
				{
					"name": "Negative Scenarios",
					"item": [
						{
							"name": "Create User - Duplicate Phone",
							"id": "50488459-3923e164-76f4-427f-8cdb-75abbc183e15",
							"protocolProfileBehavior": {
								"disableBodyPruning": true
							},
							"request": {
								"method": "POST",
								"header": [],
								"url": {
									"raw": "{{baseUrl}}/user/create",
									"host": [
										"{{baseUrl}}"
									],
									"path": [
										"user",
										"create"
									]
								}
							},
							"response": []
						},
						{
							"name": "Create User - Unauthorized (No Token)",
							"id": "50488459-84eeb73e-7489-4785-9a28-f995f3c31393",
							"protocolProfileBehavior": {
								"disableBodyPruning": true
							},
							"request": {
								"method": "POST",
								"header": [],
								"url": {
									"raw": "{{baseUrl}}/user/create",
									"host": [
										"{{baseUrl}}"
									],
									"path": [
										"user",
										"create"
									]
								}
							},
							"response": []
						}
					],
					"id": "50488459-51077ad5-aa81-4664-9f52-bd069ec7ab01"
				}
			],
			"id": "50488459-c723f8de-51b0-4542-a005-24503b40438a",
			"description": "Admin creating Agent, Customers, and Merchant.",
			"event": [
				{
					"listen": "prerequest",
					"script": {
						"id": "acd2e6f3-c944-48f4-934a-4d805d8cc182",
						"type": "text/javascript",
						"packages": {},
						"requests": {},
						"exec": [
							""
						]
					}
				},
				{
					"listen": "test",
					"script": {
						"id": "30484714-a114-4031-a6a9-a5aea10a3d26",
						"type": "text/javascript",
						"packages": {},
						"requests": {},
						"exec": [
							""
						]
					}
				}
			]
		},
		{
			"name": "03. Money Flow & Distribution",
			"item": [
				{
					"name": "System to Agent Deposit",
					"id": "50488459-dcba282a-2f7c-403f-a28f-977e2e8ef7b3",
					"protocolProfileBehavior": {
						"disableBodyPruning": true
					},
					"request": {
						"method": "POST",
						"header": [],
						"url": {
							"raw": "{{baseUrl}}/transaction/deposit",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"transaction",
								"deposit"
							]
						}
					},
					"response": []
				},
				{
					"name": "Agent to Customer Deposit",
					"id": "50488459-a2e0fd3f-28f3-4d99-9e7c-6ce1bde6863b",
					"protocolProfileBehavior": {
						"disableBodyPruning": true
					},
					"request": {
						"method": "POST",
						"header": [],
						"url": {
							"raw": "{{baseUrl}}/transaction/deposit",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"transaction",
								"deposit"
							]
						}
					},
					"response": []
				},
				{
					"name": "Customer to Customer Send Money",
					"id": "50488459-3788a693-e960-4d52-9739-ebe391ae6873",
					"protocolProfileBehavior": {
						"disableBodyPruning": true
					},
					"request": {
						"method": "POST",
						"header": [],
						"url": {
							"raw": "{{baseUrl}}/transaction/sendmoney",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"transaction",
								"sendmoney"
							]
						}
					},
					"response": []
				},
				{
					"name": "Negative - Insufficient Balance Transfer",
					"id": "50488459-f986b762-5857-4437-90be-b32ed8a1faa8",
					"protocolProfileBehavior": {
						"disableBodyPruning": true
					},
					"request": {
						"method": "POST",
						"header": [],
						"url": {
							"raw": "{{baseUrl}}/transaction/sendmoney",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"transaction",
								"sendmoney"
							]
						}
					},
					"response": []
				}
			],
			"id": "50488459-eb920b70-2a52-4ef6-baa8-e75063ae65bb",
			"description": "Handles System funding and P2P transfers."
		},
		{
			"name": "04. Merchant & Utility Flows",
			"item": [
				{
					"name": "Customer Withdrawal to Agent",
					"id": "50488459-6b889d4b-8f97-4f99-b110-f1e9638137e5",
					"protocolProfileBehavior": {
						"disableBodyPruning": true
					},
					"request": {
						"method": "POST",
						"header": [],
						"url": {
							"raw": "{{baseUrl}}/transaction/withdraw",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"transaction",
								"withdraw"
							]
						}
					},
					"response": []
				},
				{
					"name": "Customer Payment to Merchant",
					"id": "50488459-a15ca78b-a986-453a-b204-581cae1b5550",
					"protocolProfileBehavior": {
						"disableBodyPruning": true
					},
					"request": {
						"method": "POST",
						"header": [],
						"url": {
							"raw": "{{baseUrl}}/transaction/payment",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"transaction",
								"payment"
							]
						}
					},
					"response": []
				},
				{
					"name": "Negative - Withdrawal Below Minimum (10 TK)",
					"id": "50488459-676edb8d-9803-4793-8ed1-646b53eab0c4",
					"protocolProfileBehavior": {
						"disableBodyPruning": true
					},
					"request": {
						"method": "POST",
						"header": [],
						"url": {
							"raw": "{{baseUrl}}/transaction/withdraw",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"transaction",
								"withdraw"
							]
						}
					},
					"response": []
				}
			],
			"id": "50488459-a0247881-137c-49ef-82a5-415c9f1191aa",
			"description": "Withdrawals and Merchant payments."
		},
		{
			"name": "05. Inquiries & Auditing",
			"item": [
				{
					"name": "Check Agent Balance",
					"id": "50488459-77a69d4b-43fa-41e6-9f68-63a93fb8d943",
					"protocolProfileBehavior": {
						"disableBodyPruning": true
					},
					"request": {
						"method": "GET",
						"header": [],
						"url": {
							"raw": "{{baseUrl}}/transaction/balance/{{agentPhone}}",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"transaction",
								"balance",
								"{{agentPhone}}"
							]
						}
					},
					"response": []
				},
				{
					"name": "Check Customer Statement",
					"id": "50488459-393e4a8a-628e-4f68-a7bf-4b92678ca182",
					"protocolProfileBehavior": {
						"disableBodyPruning": true
					},
					"request": {
						"method": "GET",
						"header": [],
						"url": {
							"raw": "{{baseUrl}}/transaction/statement/{{customerPhone}}",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"transaction",
								"statement",
								"{{customerPhone}}"
							]
						}
					},
					"response": []
				},
				{
					"name": "Search Transaction by ID",
					"id": "50488459-5f7948f4-deac-4ef5-b294-c2233be0bbf2",
					"protocolProfileBehavior": {
						"disableBodyPruning": true
					},
					"request": {
						"method": "GET",
						"header": [],
						"url": {
							"raw": "{{baseUrl}}/transaction/search/{{trnxId}}",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"transaction",
								"search",
								"{{trnxId}}"
							]
						}
					},
					"response": []
				},
				{
					"name": "Negative - Check Balance for Invalid Phone",
					"id": "50488459-bac3722d-eb77-4dc2-aad7-b27b17599f17",
					"protocolProfileBehavior": {
						"disableBodyPruning": true
					},
					"request": {
						"method": "GET",
						"header": [],
						"url": {
							"raw": "{{baseUrl}}/transaction/balance/0000",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"transaction",
								"balance",
								"0000"
							]
						}
					},
					"response": []
				}
			],
			"id": "50488459-681ba7e7-35fc-4b57-a172-61adbd531e44",
			"description": "Balance checks and transaction history."
		}
	],
	"event": [
		{
			"listen": "prerequest",
			"script": {
				"id": "1b0273b3-233c-413b-b885-67fdf1910998",
				"type": "text/javascript",
				"packages": {},
				"requests": {},
				"exec": [
					"pm.collectionVariables.set(\"secret-key\",\"ROADTOSDET\")",
					"pm.collectionVariables.set('baseUrl',\"https://dmoney.roadtocareer.net\")",
					"pm.collectionVariables.set('systemEmail',\"system@dmoney.com\")",
					"pm.collectionVariables.set('adminEmail',\"admin@dmoney.com\")",
					"pm.collectionVariables.set('pswd',\"1234\")"
				]
			}
		},
		{
			"listen": "test",
			"script": {
				"id": "5938940d-cc42-4423-9ba5-dcddefa806c6",
				"type": "text/javascript",
				"packages": {},
				"requests": {},
				"exec": [
					""
				]
			}
		}
	],
	"variable": [
		{
			"key": "baseUrl",
			"value": ""
		},
		{
			"key": "adminEmail",
			"value": ""
		},
		{
			"key": "secret-key",
			"value": ""
		},
		{
			"key": "systemEmail",
			"value": ""
		},
		{
			"key": "pswd",
			"value": ""
		},
		{
			"key": "Admin-auth-token",
			"value": ""
		}
	]
}